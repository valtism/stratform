pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
function _init()
    p = {}
    for x = 1, 15 do
        for y = 1, 15 do
            local sprite = mget(x, y)
            if (sprite == 1) then
                p.x = x
                p.y = y
                p.dir = "right"
                mset(x, y, 0)
            end
            if (sprite == 2) then
                p.x = x
                p.y = y
                p.dir = "left"
                mset(x, y, 0)
            end
        end
    end
end

function _update() move_player() end

function _draw()
    cls()
    map(0, 0)
    spr(1, p.x * 8, p.y * 8)
end

function await_input()
    if (btnp(4)) then move_player("step") end
    if (btnp(5)) then move_player("jump") end
end

function move_player(input)
    local next = {x = p.x, y = p.y}
    local movement = nil
    local is_falling = ~is_collision(p.x, p.y+1)
    if (input == "step" and is_falling) then 
        if ()
    end

    if (btnp(0)) then next.x = p.x - 1 end
    if (btnp(1)) then next.x = p.x + 1 end
    if (btnp(2)) then next.y = p.y - 1 end
    if (btnp(3)) then next.y = p.y + 1 end
    if (p.x ~= next.x or p.y ~= next.y) then
        if can_move(next) then p = next end
    end
end

function is_collision(x,y)
    local sprite = mget(x, y)
    return fget(sprite) == 1
end

function can_move(p)
    local map_sprite = mget(p.x, p.y)
    local flag = fget(map_sprite)

    return flag ~= 1
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000660000000000000000000000660000006600000066000000660000000000000000000000000000000000000000000000000000000000000000000
00077000000660000006600000066000000660000066600000666000006660000006600000000000000000000000000000000000000000000000000000000000
00077000006660000066600000066000000660000006660000066600000666000066600000000000000000000000000000000000000000000000000000000000
00700700000666000006660000666000006660000006660000066000000660000006660000000000000000000000000000000000000000000000000000000000
00000000006060000006600000066600000666000060060006600600006606000006660000000000000000000000000000000000000000000000000000000000
00000000006060000060600000606000006060000600000000000000000000600066060000000000000000000000000000000000000000000000000000000000
33333333333333331111111111111111333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30000003bb3333331111111111cccc1133aaa7330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
303000033b33333311111111111111113aaaaa730000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3000000333333b3311111111111111113aaa9aa30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
300303033333bb33111111111ccc111139aa9aa30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
300003033333b333111111111111111139aaaa930000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
300000033b333333111111111111ccc1559aa9330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333333333331111111111111111355533330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000001010000000000000101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000001000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000001000101010101010001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000001000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000001000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000001000000100000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000001000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000001010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
